name: Deploy on change

on:
  pull_request:
  merge_group:

jobs:
  check:
    uses: ./.github/workflows/diff-based-env-trigger.yml
    with:
      paths: |
        checked_path
        README.md
      branch_env_map: |
        main=prod
        develop=dev

  deploy-dev:
    needs: check
    if: contains(needs.check.outputs.matched_envs, 'dev')
    runs-on: ubuntu-latest
    steps:
      - run: echo "ðŸš€ Deploying to dev..."

  deploy-prod:
    needs: check
    if: contains(needs.check.outputs.matched_envs, 'prod')
    runs-on: ubuntu-latest
    steps:
      - run: echo "ðŸš€ Deploying to prod..."
